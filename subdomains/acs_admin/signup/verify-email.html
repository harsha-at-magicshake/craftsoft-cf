<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verify Email - Craft Soft</title>
    <meta name="description" content="Verify your email to complete admin registration">
    <meta name="robots" content="noindex, nofollow">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="https://craftsoft.co.in/favicon.svg">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Italianno&family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Admin Styles - Base -->
    <link rel="stylesheet" href="/assets/css/base/variables.css">
    <link rel="stylesheet" href="/assets/admin/css/base/variables.css">
    <link rel="stylesheet" href="/assets/admin/css/base/reset.css">
    <link rel="stylesheet" href="/assets/admin/css/base/typography.css">
    <!-- Admin Styles - Layout -->
    <link rel="stylesheet" href="/assets/admin/css/layout/auth.css">
    <link rel="stylesheet" href="/assets/admin/css/layout/dashboard.css">
    <link rel="stylesheet" href="/assets/admin/css/layout/header.css">
    <link rel="stylesheet" href="/assets/admin/css/layout/sidebar.css">
    <!-- Admin Styles - Components -->
    <link rel="stylesheet" href="/assets/admin/css/components/buttons.css">
    <link rel="stylesheet" href="/assets/admin/css/components/forms.css">
    <link rel="stylesheet" href="/assets/admin/css/components/modals.css">
    <link rel="stylesheet" href="/assets/admin/css/components/toasts.css">
    <link rel="stylesheet" href="/assets/admin/css/components/tables.css">
    <link rel="stylesheet" href="/assets/admin/css/components/cards.css">
    <link rel="stylesheet" href="/assets/admin/css/components/badges.css">
    <link rel="stylesheet" href="/assets/admin/css/components/account-panel.css">
    <!-- Admin Styles - Utilities -->
    <link rel="stylesheet" href="/assets/admin/css/utilities/skeleton.css">
    <link rel="stylesheet" href="/assets/admin/css/utilities/helpers.css">
    <!-- Admin Styles - Responsive -->
    <link rel="stylesheet" href="/assets/admin/css/responsive/tablet.css">
    <link rel="stylesheet" href="/assets/admin/css/responsive/mobile.css">
</head>

<body>
    <div class="auth-container">
        <!-- Logo -->
        <div class="auth-logo">
            <span class="logo-text"><span class="logo-signature">Abhi's</span> <span class="highlight">Craft
                    Soft</span></span>
        </div>

        <!-- Verify Email Card -->
        <div class="auth-card">
            <div class="verify-icon">
                <i class="fa-solid fa-envelope"></i> </div>

            <div class="auth-header">
                <h1>Check Your Email</h1>
                <p>We've sent a verification link to:</p>
                <p class="verify-email-text" id="email-display">your-email@example.com</p>
            </div>

            <ul class="verify-steps">
                <li>
                    <i class="fa-solid fa-inbox"></i> <span>Check your inbox (and spam folder)</span>
                </li>
                <li>
                    <i class="fa-solid fa-mouse-pointer"></i> <span>Click the verification link in the email</span>
                </li>
                <li>
                    <i class="fa-solid fa-arrow-right-to-bracket"></i> <span>You'll be redirected to the login page</span>
                </li>
            </ul>

            <button id="resend-btn" class="btn btn-outline btn-full" disabled>
                <i class="fa-solid fa-paper-plane"></i> Resend Verification Email
            </button>
            <p id="resend-timer" class="resend-timer">Resend available in <span id="countdown">60</span> seconds</p>

            <!-- Card Footer -->
            <div class="auth-card-footer">
                <a href="https://signup.craftsoft.co.in" class="back-link">
                    <i class="fa-solid fa-arrow-left"></i> Back to Sign Up
                </a>
                <div style="margin-top: 1rem;"></div>
                <a href="https://craftsoft.co.in" class="back-link">
                    <i class="fa-solid fa-globe"></i> Back to Website
                </a>
            </div>
        </div>
    </div>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/assets/admin/js/supabase-config.js"></script>
    <script src="/assets/admin/js/admin-utils.js"></script>
    <script src="/assets/admin/js/auth.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const { Toast, getTempEmail, clearTempEmail, NavigationSecurity } = window.AdminUtils;

            // Initialize navigation protection
            NavigationSecurity.initPublicPage();

            // Prevent back/forward navigation
            history.pushState(null, '', location.href);
            window.addEventListener('popstate', () => {
                history.pushState(null, '', location.href);
            });

            const email = getTempEmail();
            const emailDisplay = document.getElementById('email-display');
            const resendBtn = document.getElementById('resend-btn');
            const resendTimer = document.getElementById('resend-timer');
            const countdownEl = document.getElementById('countdown');

            // Display email
            if (email) {
                emailDisplay.textContent = email;
            } else {
                // No email stored, redirect to signup
                window.location.href = 'https://signup.craftsoft.co.in';
                return;
            }

            // Countdown timer for resend
            let countdown = 60;
            const timer = setInterval(() => {
                countdown--;
                countdownEl.textContent = countdown;

                if (countdown <= 0) {
                    clearInterval(timer);
                    resendBtn.disabled = false;
                    resendTimer.style.display = 'none';
                }
            }, 1000);

            // Resend verification email
            resendBtn.addEventListener('click', async () => {
                if (resendBtn.disabled) return;

                resendBtn.disabled = true;
                resendBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Sending...';

                const result = await window.Auth.resendVerification(email);

                if (result.success) {
                    Toast.success('Email Sent', 'Verification email has been resent');

                    // Reset countdown
                    countdown = 60;
                    resendTimer.style.display = 'block';
                    countdownEl.textContent = countdown;

                    resendBtn.innerHTML = '<i class="fa-solid fa-paper-plane"></i> Resend Verification Email';

                    const newTimer = setInterval(() => {
                        countdown--;
                        countdownEl.textContent = countdown;

                        if (countdown <= 0) {
                            clearInterval(newTimer);
                            resendBtn.disabled = false;
                            resendTimer.style.display = 'none';
                        }
                    }, 1000);
                } else {
                    Toast.error('Failed', result.error || 'Could not resend verification email');
                    resendBtn.disabled = false;
                    resendBtn.innerHTML = '<i class="fa-solid fa-paper-plane"></i> Resend Verification Email';
                }
            });
        });
    </script>
</body>

</html>








